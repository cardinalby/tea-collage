{"version":3,"sources":["collage-info sync /^/.//.*/.json$","i18n/config.ts","models/reactUtils.ts","hooks/useComponentId.ts","components/SmoothImage.tsx","components/OverlayLayer.tsx","models/canvasUtils.ts","components/ImageMapper.tsx","hooks/useIsMounted.ts","hooks/useFittedScale.ts","hooks/useElementSize.ts","components/TeapotSpinner.tsx","components/OverlayedImageMapper.tsx","models/collageSources.ts","models/collageSourcesSet.ts","hooks/useImgLoadingEvents.ts","hooks/useOverlayImagesPreloader.ts","models/disposableTimers.ts","hooks/useMouseHoverArea.ts","hooks/useDisposableTimers.ts","hooks/useStateSafe.ts","hooks/useDocumentKeyDown.ts","hooks/useDocumentTitle.ts","components/HitsCounter.tsx","components/Collage.tsx","images/close_icon.svg","components/InfoWindow.tsx","images/quality_gear.svg","components/QualitySelector.tsx","images/full_screen.svg","images/full_screen_exit.svg","components/FullScreenSwitch.tsx","hooks/useLanguage.ts","components/LanguageSelector.tsx","models/strUtils.ts","images/github_logo.svg","components/GithubLink.tsx","components/AboutLink.tsx","components/ControlPanel.tsx","models/photosSources.ts","models/sizeAutoSelector.ts","hooks/useCollageSize.ts","components/AppContents.tsx","hooks/useHtmlElementLang.ts","hooks/useWindowAspectRatio.ts","components/App.tsx","index.tsx"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","i18n","use","detector","Backend","initReactI18next","init","detection","lookupQuerystring","undefined","lookupCookie","lookupLocalStorage","lookupSessionStorage","lookupFromPathIndex","lookupFromSubdomainIndex","supportedLngs","load","backend","loadPath","process","classNames","className","Array","concat","filter","name","trim","reduce","acc","names","join","counter","SmoothImageLoadEventsWrapper","events","onError","onLoad","onLoading","SmoothImage","props","providedId","useState","fullLoaded","setFullLoaded","previewLoaded","setPreviewLoaded","previewSrc","useRef","fullSrc","componentId","Symbol","loadEvents","useMemo","fullImg","previewImg","current","src","onImgRef","node","preview","imgRef","willUnmount","useEffect","onImgLoad","event","target","onImgError","imgProps","style","otherImgProps","addClassName","value","containerProps","alt","ref","position","OverlayLayer","ctx","setCtx","actualImg","isTransparentMouseHoverPoint","t","useTranslation","isTransparentPoint","HTMLDivElement","HTMLImageElement","canvasPoint","rect","getBoundingClientRect","x","clientX","left","naturalWidth","clientWidth","y","clientY","top","naturalHeight","clientHeight","getCanvasCoordsByImgMouseEvent","point","getImageData","data","getCanvasPointAlpha","onMouseMove","onMouseHover","isTransparent","containerClass","onClick","onMouseLeave","onMouseEnter","layerId","component","element","canvas","document","createElement","width","height","getContext","drawImage","dimensions","ImageMapper","styles","container","pointerEvents","zIndex","img","userSelect","selectedArea","getScaledMap","memoize","scaleCoords","coords","coord","index","areas","area","isEqual","forEach","f","bind","cursor","prevProps","this","initCanvas","shape","drawCircle","drawPoly","drawRect","fillColor","lineWidth","strokeColor","right","bot","fillStyle","strokeStyle","strokeRect","fillRect","beginPath","arc","Math","PI","closePath","stroke","fill","handleBorder","maxSize","min","max","limit","floor","ceil","handleCoordsPair","coordsPair","a","v","i","s","slice","first","unshift","moveTo","pair","lineTo","group","active","getAreasByGroup","areaToDraw","drawMethod","getDrawMethod","defaultProps","clearRect","preventDefault","onImageClick","hoverOn","teaName","title","hoverOff","mouseMove","click","href","_id","containerClassName","onImgLoaded","useMap","imageClick","renderAreas","Component","useIsMounted","componentIsMounted","useFittedScale","containerSize","size","setSize","isMounted","useLayoutEffect","window","addEventListener","updateSize","removeEventListener","useElementSize","random","TeapotSpinner","collageSources","getOverlayDimensions","scale","getOverlayUrl","ImageMapperTranslated","withTranslation","selfPropNames","Set","OverlayedImageMapper","fitToElement","full","background","prevOverlayLayer","overlayHoverOnTransparent","setOverlayHoverOnTransparent","overlayLayerId","overlay","isTransparentArea","onOverlayClick","imgMapperProps","fromEntries","key","has","getImageMapperProps","round","getBackgroundUrl","imgWidth","areasMap","showLoader","children","extractedDir","OverlayDimensions","CollageSources","fullName","previewName","info","_getInfo","dir","collage","fileName","overlayItem","overlayItems","collageItem","getCollageInfo","collageSizes","require","sizesMap","previewSize","collageAspectRatio","sort","b","Map","find","from","values","setName","mapName","useImgLoadingEvents","loadingFull","setLoadingFull","loadingPreview","setLoadingPreview","getLoading","setLoading","deleteLoading","loading","delete","eventHandlers","add","addLoading","onHidden","isLoading","isPreview","collectUrls","sources","items","itemId","indexOf","url","DisposableTimers","_timeoutTimers","_intervalTimers","handler","timeout","args","handleId","setTimeout","setInterval","clearTimeout","clear","clearInterval","clearTimeoutTimers","clearIntervalTimers","useMouseHoverArea","startPreloadAfterMs","stopPreloadAfterMs","hoverAreaGroup","preloadGroup","setPreloadGroup","disposableTimers","useDisposableTimers","onMouseEnterArea","onMouseLeaveArea","useStateSafe","initialState","state","setState","useDocumentKeyDown","listener","useDocumentTitle","oldTitle","getImgUrl","trackedUrl","encodeURIComponent","getGraphUrl","HitsCounter","display","visible","Collage","imagesLoadingHandler","imgLoadingEvents","containerRef","setContainerRef","setLayerId","history","useHistory","mouseHoverArea","closeOverlay","loadPreview","loadFull","images","requiredItems","entry","requiredUrlsMap","existingUrl","existingImg","get","requiredUrl","image","Image","itemInfo","onload","set","useOverlayImagesPreloader","imageMapper","collageSourcesSet","getAreasMap","push","currentTarget","_extends","assign","arguments","length","source","prototype","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_ref2","points","SvgCloseIcon","_ref","svgRef","titleId","xmlns","viewBox","enableBackground","xmlSpace","ForwardRef","InfoWindow","goToCollage","item","translatedData","isImgZoomed","setImgZoomed","paragraphs","description","paragraph","imgSrc","d","SvgQualityGear","xmlnsXlink","QualitySelector","sizeShortName","currentSize","menuItems","sizes","sizeDef","onSelection","val","onChange","tag","fillRule","SvgFullScreen","SvgFullScreenExit","FullScreenSwitch","screenFull","isEnabled","isFullscreen","setIsFullscreen","exit","then","request","clearBackendCacheIfFailed","lang","backendState","services","backendConnector","getSupportedLanguages","languageUtils","useLanguage","initLang","resourceStore","language","fallbackLanguages","getFallbackCodes","foundFallback","getInitLanguage","changeLanguage","currentLang","setCurrentLang","LanguageSelector","langWithoutCode","getLanguagePartFromCode","currentLangIndex","buttons","string","charAt","toUpperCase","clipRule","SvgGithubLogo","GithubLink","AboutLink","ControlPanel","getSizes","collageSizeName","onCollageSizeChange","photosInfo","photosDirUrl","getDirUrl","previewsDirName","files","file","teas","fileIndex","calcScore","factor","actual","worst","zero","best","toBytesPerSec","mBitsPerSec","isUserGoingToZoom","test","navigator","userAgent","screen","STORAGE_SIZE_PREF_KEY","useCollageSize","prefSize","sessionStorage","getItem","recommendedSize","sizesScore","addScore","score","currentScore","connection","downlink","estimatedLoadTimeSec","avgImgSize","bestLoadTimeSec","speedScore","saveData","saveDataScore","biggestScreenDimensionPx","devicePixelRatio","bestScreenBigDimension","screenSizeScore","prev","getRecommendedCollageSize","setItem","AppContents","oldLang","documentElement","useHtmlElementLang","classes","setCollageSizeName","getSources","body","aspectRatio","updateAspectRatio","innerWidth","innerHeight","classList","toggle","infoWindow","redirect","section","returnObjects","defaultValue","photosSources","getTeaPhotoUrl","replace","to","getRouteParam","routeProps","paramName","foundProps","match","params","param","App","renderContents","TranslatedContents","Suspense","fallback","path","render","exact","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.b037b1a2.chunk.js","sourcesContent":["var map = {\n\t\"./areas-map.json\": 39,\n\t\"./large.json\": 74,\n\t\"./medium.json\": 75,\n\t\"./photos-info.json\": 41,\n\t\"./preview.json\": 76,\n\t\"./sizes.json\": 38,\n\t\"./small.json\": 77\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 40;","import i18n from 'i18next';\nimport { initReactI18next } from 'react-i18next';\nimport detector from \"i18next-browser-languagedetector\";\nimport Backend from 'i18next-fetch-backend';\n\n// noinspection JSIgnoredPromiseFromCall\ni18n\n    .use(detector)\n    .use(Backend)\n    .use(initReactI18next)\n    .init({\n        detection: {\n            lookupQuerystring: undefined,\n            lookupCookie: undefined,\n            lookupLocalStorage: 'i18nextLng',\n            lookupSessionStorage: undefined,\n            lookupFromPathIndex: undefined,\n            lookupFromSubdomainIndex: undefined,\n        },\n        supportedLngs: ['en', 'ru'],\n        load: 'languageOnly',\n        backend: {\n            loadPath: process.env.PUBLIC_URL + '/i18n/{{lng}}.json',\n        }\n    });\n","type ClassName = string|undefined|false;\n\nexport function classNames(\n    ...classNames: (ClassName|ClassName[])[]\n) {\n    return classNames\n        .map(className =>\n            (new Array<ClassName>())\n                .concat(className)\n                .filter(name => name)\n                .map(name => (name as string).trim())\n        )\n        .reduce((acc, names) => acc.concat(names), [])\n        .join(' ');\n}","import {useState} from \"react\";\n\nlet counter = 1;\nexport function useComponentId(providedId: string|undefined, name: string) {\n    return useState(providedId || Symbol(name + '_' + counter++))[0];\n}","import '../css/smoothImage.css';\nimport React, {useEffect, useMemo, useRef, useState} from \"react\";\nimport {classNames} from \"../models/reactUtils\";\nimport {useComponentId} from \"../hooks/useComponentId\";\n\nexport type SmoothImageEvent = (target: HTMLImageElement, preview: boolean, component: any) => void;\n\nexport interface SmoothImageLoadEvents {\n    onError?: SmoothImageEvent,\n    onLoad?: SmoothImageEvent,\n    onLoading?: SmoothImageEvent\n}\n\nexport class SmoothImageLoadEventsWrapper implements SmoothImageLoadEvents {\n    public constructor(\n        public events?: SmoothImageLoadEvents,\n    ) {\n    }\n\n    onError: SmoothImageEvent = (...args) =>\n        this.events?.onError && this.events.onError(...args);\n\n    onLoad: SmoothImageEvent = (...args) =>\n        this.events?.onLoad && this.events.onLoad(...args);\n\n    onLoading: SmoothImageEvent = (...args) =>\n        this.events?.onLoading && this.events.onLoading(...args);\n}\n\nexport interface SmoothImageProps {\n    componentId?: string,\n    imgRef?: (img: HTMLImageElement, preview: boolean) => void,\n    src: string,\n    previewSrc?: string,\n    imgProps: React.DetailedHTMLProps<React.ImgHTMLAttributes<HTMLImageElement>, HTMLImageElement>,\n    containerProps?: React.DetailedHTMLProps<React.HTMLAttributes<HTMLDivElement>, HTMLDivElement>\n    loadEvents?: SmoothImageLoadEvents\n}\n\nexport function SmoothImage(props: SmoothImageProps) {\n    const [fullLoaded, setFullLoaded] = useState(false);\n    const [previewLoaded, setPreviewLoaded] = useState(false);\n    const previewSrc = useRef<string|undefined>(undefined);\n    const fullSrc = useRef<string|undefined>(undefined);\n    const componentId = useComponentId(props.componentId, 'smooth_image');\n\n    const loadEvents = useMemo(() => new SmoothImageLoadEventsWrapper(props.loadEvents), [props.loadEvents]);\n    const fullImg = useRef(undefined as HTMLImageElement|undefined);\n    const previewImg = useRef(undefined as HTMLImageElement|undefined);\n\n    if (previewSrc.current !== props.previewSrc) {\n        previewSrc.current = props.previewSrc;\n        if (previewImg.current) {\n            previewImg.current = undefined;\n        }\n    }\n    if (fullSrc.current !== props.src) {\n        fullSrc.current = props.src;\n        if (fullImg.current) {\n            fullImg.current = undefined;\n        }\n    }\n\n    const onImgRef = (node, preview) => {\n        if (node === null) {\n            return;\n        }\n        if (props.imgRef) {\n            props.imgRef(node, preview)\n        }\n        const imgRef = (preview ? previewImg : fullImg);\n        if (!imgRef.current) {\n            loadEvents.onLoading(node, preview, componentId);\n        }\n        imgRef.current = node;\n    }\n\n    const willUnmount = useRef(false);\n    useEffect(() => { return () => {\n        willUnmount.current = true;\n    }}, []);\n\n    useEffect(() => { return () => {\n        if (willUnmount.current) {\n            if (!previewLoaded && previewImg.current) {\n                loadEvents.onError(previewImg.current, true, componentId);\n            }\n            if (!fullLoaded && fullImg.current) {\n                loadEvents.onError(fullImg.current, false, componentId);\n            }\n        }\n    }}, [previewLoaded, fullLoaded, componentId, loadEvents]);\n\n    const onImgLoad = (event, preview) => {\n        loadEvents.onLoad(event.target as HTMLImageElement, preview, componentId);\n        if (!willUnmount.current) {\n            preview ? setPreviewLoaded(true) : setFullLoaded(true);\n        }\n    }\n\n    const onImgError = (event, preview) => {\n        loadEvents.onError(event.target as HTMLImageElement, preview, componentId);\n    }\n\n    const {style, className, ...otherImgProps} = (props.imgProps || {});\n    const addClassName = (value: string|undefined|(string|undefined)[]): string =>\n        classNames(props.imgProps && props.imgProps.className, value);\n\n    return(\n        <div {...props.containerProps}>\n            {props.previewSrc &&\n                <img\n                    src={props.previewSrc}\n                    alt={props.imgProps.alt}\n                    ref={node => onImgRef(node, true)}\n                    onLoad={event => onImgLoad(event, true)}\n                    onError={event => onImgError(event, true)}\n                    className={addClassName([\n                        'smooth-img',\n                        'preview',\n                        previewLoaded ? 'ready' : (previewImg.current ? 'loading' : 'init')\n                    ])}\n                    style={{\n                        ...style,\n                        position: 'absolute'\n                    }}\n                    {...otherImgProps}\n                />\n            }\n            <img\n                src={props.src}\n                alt={props.imgProps.alt}\n                ref={node => onImgRef(node, false)}\n                onLoad={event => onImgLoad(event, false)}\n                onError={event => onImgError(event, false)}\n                {...props.imgProps}\n                className={addClassName([\n                    'smooth-img',\n                    'full',\n                    fullLoaded ? 'ready' : (fullImg.current ? 'loading' : 'init')\n                ])}\n                style={{\n                    ...style,\n                    position: 'relative'\n                }}\n            />\n        </div>\n    );\n}","import '../css/overlay.css';\nimport React, {MouseEvent, useRef, useState} from 'react';\nimport {SmoothImageLoadEvents, SmoothImageLoadEventsWrapper, SmoothImage} from \"./SmoothImage\";\nimport {getCanvasPointAlpha} from \"../models/canvasUtils\";\nimport {Point2d} from \"../models/point2d\";\nimport { useTranslation } from 'react-i18next';\nimport {OverlayDimensions} from \"../models/collageSources\";\n\ntype DivMouseEvent = MouseEvent<HTMLDivElement>;\ntype ImgMouseEvent = MouseEvent<HTMLImageElement>;\ntype LayerMouseEvent = DivMouseEvent|ImgMouseEvent;\n\ninterface OverlayLayerProps {\n    layerId?: string,\n    containerClass?: string\n    src: string,\n    previewSrc?: string,\n    dimensions: OverlayDimensions\n    loadEvents?: SmoothImageLoadEvents,\n    onClick?: (event: LayerMouseEvent, isTransparentArea: boolean) => void\n    onMouseHover?: (event: LayerMouseEvent, isTransparentArea: boolean) => void\n    onMouseLeave?: (event: LayerMouseEvent) => void\n}\n\nfunction OverlayLayer(props: OverlayLayerProps)\n{\n    const loadEvents = new SmoothImageLoadEventsWrapper(props.loadEvents)\n    const [ctx, setCtx] = useState<CanvasRenderingContext2D|undefined>();\n    const actualImg = useRef<{element: HTMLImageElement, preview: boolean}>();\n    const isTransparentMouseHoverPoint = useRef<boolean>();\n    const { t } = useTranslation();\n\n    const onImageLoad = (target: HTMLImageElement, preview: boolean, component) => {\n        if (!actualImg.current || actualImg.current.preview === preview || !preview) {\n            actualImg.current = { element: target, preview };\n        }\n        const canvas = document.createElement('canvas');\n        canvas.width = target.naturalWidth;\n        canvas.height = target.naturalHeight;\n        const ctx = canvas.getContext('2d');\n        if (!ctx) {\n            throw new Error(\"Can't get 2d context\");\n        }\n        ctx.drawImage(target, 0, 0, canvas.width, canvas.height);\n        setCtx(ctx);\n        loadEvents.onLoad(target, preview, component);\n    };\n\n    function getCanvasCoordsByImgMouseEvent(event: ImgMouseEvent): Point2d {\n        const target = event.target as HTMLImageElement;\n        const rect = target.getBoundingClientRect();\n        return {\n            x: (event.clientX - rect.left) * target.naturalWidth / target.clientWidth,\n            y: (event.clientY - rect.top) * target.naturalHeight / target.clientHeight\n        };\n    }\n\n    function isTransparentPoint(event: LayerMouseEvent): boolean {\n        if (event.target instanceof HTMLDivElement) {\n            return true;\n        }\n        if (ctx && event.target instanceof HTMLImageElement) {\n            const canvasPoint = getCanvasCoordsByImgMouseEvent(event as ImgMouseEvent);\n            return getCanvasPointAlpha(ctx, canvasPoint) < 5;\n        }\n        return false;\n    }\n\n    function onMouseMove(event: LayerMouseEvent): void {\n        if (props.onMouseHover) {\n            const isTransparent = isTransparentPoint(event);\n            if (isTransparent !== isTransparentMouseHoverPoint.current) {\n                props.onMouseHover(event, isTransparent);\n                isTransparentMouseHoverPoint.current = isTransparent;\n            }\n        }\n    }\n\n    function onMouseLeave(event: DivMouseEvent) {\n        if (props.onMouseLeave) {\n            props.onMouseLeave(event);\n        }\n        isTransparentMouseHoverPoint.current = undefined;\n    }\n\n    function onMouseClick(event: LayerMouseEvent): void {\n        if (props.onClick) {\n            props.onClick(event ,isTransparentPoint(event));\n        }\n    }\n\n    return (\n        <div className={props.containerClass}\n             onMouseMove={onMouseMove}\n             onClick={onMouseClick}\n             onMouseLeave={onMouseLeave}\n             onMouseEnter={onMouseMove}\n        >\n            <SmoothImage\n                componentId={props.layerId}\n                src={props.src}\n                previewSrc={props.previewSrc}\n                loadEvents={{\n                    ...loadEvents,\n                    onLoad: onImageLoad\n                }}\n                imgProps={{\n                    style: {\n                        left: props.dimensions.left,\n                        top: props.dimensions.top,\n                        width: props.dimensions.width,\n                        height: props.dimensions.height,\n                    },\n                    alt: props.layerId ? t(`teas.${props.layerId}.name`) : '',\n                }}\n            />\n        </div>\n    );\n}\n\nexport default OverlayLayer;\n","import {Point2d} from \"./point2d\";\n\nexport function getCanvasPointAlpha(ctx: CanvasRenderingContext2D, point: Point2d): number {\n    return ctx.getImageData(point.x, point.y, 1, 1).data[3];\n}","import React, {Component, CSSProperties, MouseEventHandler} from \"react\";\nimport isEqual from \"react-fast-compare\";\nimport memoize from \"memoize-one\";\nimport {SmoothImageLoadEvents, SmoothImageLoadEventsWrapper, SmoothImage} from \"./SmoothImage\";\nimport {TFunction} from \"i18next\";\n\nexport type ImageMapperMouseEvent = (\n    area: ImageMapperArea,\n    index: number,\n    event: MouseEventHandler<HTMLAreaElement>\n) => void\n\nexport interface ImageMapperArea {\n    _id?: string,\n    group?: string,\n    coords: number[],\n    href?: string,\n    shape: ShapeName,\n    fillColor?: string,\n    lineWidth?: number,\n    strokeColor?: string\n}\n\nexport interface ImageMapperMap {\n    areas: ImageMapperArea[],\n    name: string\n}\n\nexport interface ImageMapperSizeProps {\n    width: number,\n    height: number,\n}\n\nexport interface ImageMapperStyleProps {\n    t?: TFunction,\n    fillColor?: string,\n    strokeColor?: string,\n    lineWidth?: number,\n    containerClassName?: string\n}\n\nexport interface ImageMapperSourceProps {\n    imgWidth: number,\n    src: string,\n    previewSrc: string,\n    map: ImageMapperMap\n}\n\nexport interface ImageMapperBehaviorProps {\n    active?: boolean,\n    onClick?: ImageMapperMouseEvent,\n    onMouseMove?: ImageMapperMouseEvent,\n    onImageClick?: MouseEventHandler<HTMLImageElement>,\n    loadEvents: SmoothImageLoadEvents,\n    onMouseEnter?: ImageMapperMouseEvent,\n    onMouseLeave?: ImageMapperMouseEvent,\n}\n\nexport interface ImageMapperProps extends\n    ImageMapperSizeProps,\n    ImageMapperStyleProps,\n    ImageMapperSourceProps,\n    ImageMapperBehaviorProps\n{}\n\ninterface ImageMapperState {}\n\ntype ShapeName = 'poly'|'circle'|'rect';\n\ntype DrawMethod = (\n    ctx: CanvasRenderingContext2D,\n    coords: number[],\n    fillColor: string,\n    lineWidth: number,\n    strokeColor: string\n) => void;\n\nexport default class ImageMapper extends Component<ImageMapperProps, ImageMapperState> {\n\n    static defaultProps = {\n        active: true,\n        fillColor: \"rgba(255, 255, 255, 0.5)\",\n        lineWidth: 1,\n        map: {\n            areas: [],\n            name: \"image-map-\" + Math.random()\n        },\n        strokeColor: \"rgba(0, 0, 0, 1)\"\n    };\n\n    styles = {\n        container: { position: \"relative\" } as CSSProperties,\n        canvas: {\n            position: \"absolute\",\n            top: 0,\n            left: 0,\n            pointerEvents: \"none\",\n            zIndex: 2\n        } as CSSProperties,\n        img: {\n            position: \"absolute\",\n            top: 0,\n            left: 0,\n            width: '100%',\n            height: '100%',\n            zIndex: 1,\n            userSelect: \"none\"\n        } as CSSProperties,\n        map: undefined as undefined | any\n    }\n\n    selectedArea?: ImageMapperArea;\n    canvas: HTMLCanvasElement|null = null;\n    ctx: CanvasRenderingContext2D|null = null;\n    container: HTMLDivElement|null = null;\n    img: HTMLImageElement|null = null;\n    loadEvents = new SmoothImageLoadEventsWrapper();\n\n    constructor(props) {\n        super(props);\n        [\n            \"drawRect\",\n            \"drawCircle\",\n            \"drawPoly\",\n            \"initCanvas\"\n        ].forEach(f => (this[f] = this[f].bind(this)));\n        this.styles.map = props.onClick && { cursor: \"pointer\" };\n    }\n\n    componentDidUpdate(prevProps: Readonly<ImageMapperProps>) {\n        if ((\n            this.props.width !== prevProps.width ||\n            this.props.height !== prevProps.height ||\n            !isEqual(this.props.map, prevProps.map)\n            ) &&\n            this.canvas && this.container\n        ) {\n            this.initCanvas(this.canvas, this.container);\n        }\n    }\n\n    getScaledMap = memoize((map: ImageMapperMap, width: number, height: number): ImageMapperMap => {\n        const scaleCoords = (coords: number[], width: number, height: number): number[] =>\n            coords.map((coord, index) =>\n                index % 2\n                    ? coord * height // vertical coord\n                    : coord * width // horizontal coord\n            );\n        return {\n            name: map.name,\n            areas: map.areas.map(area => ({\n                ...area,\n                coords: scaleCoords(area.coords, width, height)\n            }))\n        };\n    }, isEqual) ;\n\n    protected getDrawMethod(shape: ShapeName): DrawMethod|undefined {\n        switch (shape) {\n            case \"circle\": return this.drawCircle;\n            case \"poly\": return this.drawPoly;\n            case \"rect\": return this.drawRect;\n        }\n    }\n\n    protected drawRect(ctx: CanvasRenderingContext2D, coords, fillColor, lineWidth, strokeColor) {\n        let [left, top, right, bot] = coords;\n        ctx.fillStyle = fillColor;\n        ctx.lineWidth = lineWidth;\n        ctx.strokeStyle = strokeColor;\n        ctx.strokeRect(left, top, right - left, bot - top);\n        ctx.fillRect(left, top, right - left, bot - top);\n        ctx.fillStyle = this.props.fillColor || '';\n    }\n\n    protected drawCircle(ctx: CanvasRenderingContext2D, coords, fillColor, lineWidth, strokeColor) {\n        ctx.fillStyle = fillColor;\n        ctx.beginPath();\n        ctx.lineWidth = lineWidth;\n        ctx.strokeStyle = strokeColor;\n        ctx.arc(coords[0], coords[1], coords[2], 0, 2 * Math.PI);\n        ctx.closePath();\n        ctx.stroke();\n        ctx.fill();\n        ctx.fillStyle = this.props.fillColor || '';\n    }\n\n    protected drawPoly(ctx: CanvasRenderingContext2D, coords, fillColor, lineWidth, strokeColor) {\n\n        function limit(value: number, min: number, max: number): number {\n            return value < min ? min : (value > max ? max : value);\n        }\n        function handleBorder(value: number, maxSize: number): number {\n            return limit(value, Math.floor(lineWidth/2), Math.ceil(maxSize - lineWidth/2));\n        }\n        function handleCoordsPair(coordsPair: [number, number]): [number, number] {\n            return [\n                handleBorder(coordsPair[0], ctx.canvas.clientWidth),\n                handleBorder(coordsPair[1], ctx.canvas.clientHeight)\n            ];\n        }\n        coords = coords.reduce(\n            (a, v, i, s) => (i % 2 ? a : [...a, s.slice(i, i + 2)]),\n            []\n        );\n        ctx.fillStyle = fillColor;\n        ctx.beginPath();\n        ctx.lineWidth = lineWidth;\n        ctx.strokeStyle = strokeColor;\n        let first = coords.unshift();\n        ctx.moveTo(...handleCoordsPair(first));\n        coords.forEach(pair => ctx.lineTo(...handleCoordsPair(pair)));\n        ctx.closePath();\n        ctx.fill();\n        ctx.stroke();\n        ctx.fillStyle = this.props.fillColor || '';\n    }\n\n    protected initCanvas(canvas: HTMLCanvasElement, container: HTMLDivElement) {\n        const width = this.props.width || (this.img && this.img.clientWidth);\n        const height = this.props.height || (this.img && this.img.clientHeight);\n        if (!width || !height) {\n            return;\n        }\n        canvas.width = width;\n        canvas.height = height;\n        container.style.width = width + \"px\";\n        container.style.height = height + \"px\";\n        this.ctx = canvas.getContext(\"2d\");\n        if (!this.ctx) {\n            throw new Error(\"Can't get 2d context\");\n        }\n        this.ctx.fillStyle = this.props.fillColor || '';\n    }\n\n    protected getAreasByGroup(group: string) {\n        return this.getScaledMap(this.props.map, this.props.width, this.props.height)\n            .areas\n            .filter(area => area.group === group);\n    };\n\n    protected hoverOn(area: ImageMapperArea, index, event) {\n        if (this.props.active && this.ctx) {\n            this.selectedArea = area;\n            const areas = area.group\n                ? this.getAreasByGroup(area.group)\n                : [area];\n            for (const areaToDraw of areas) {\n                const drawMethod = this.getDrawMethod(areaToDraw.shape);\n                drawMethod && drawMethod(\n                    this.ctx,\n                    areaToDraw.coords,\n                    areaToDraw.fillColor || this.props.fillColor || ImageMapper.defaultProps.fillColor,\n                    areaToDraw.lineWidth || this.props.lineWidth || ImageMapper.defaultProps.lineWidth,\n                    areaToDraw.strokeColor || this.props.strokeColor || ImageMapper.defaultProps.strokeColor\n                );\n            }\n        }\n\n        if (this.props.onMouseEnter) {\n            this.props.onMouseEnter(area, index, event);\n        }\n    }\n\n    protected hoverOff(area, index, event) {\n        if (this.props.active && this.ctx && this.canvas) {\n            this.selectedArea = undefined;\n            this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n        }\n\n        if (this.props.onMouseLeave) this.props.onMouseLeave(area, index, event);\n    }\n\n    protected click(area, index, event) {\n        if (this.props.onClick) {\n            event.preventDefault();\n            this.props.onClick(area, index, event);\n        }\n    }\n\n    protected imageClick(event) {\n        if (this.props.onImageClick) {\n            event.preventDefault();\n            this.props.onImageClick(event);\n        }\n    }\n\n    protected mouseMove(area, index, event) {\n        if (this.props.onMouseMove) {\n            this.props.onMouseMove(area, index, event);\n        }\n        if (!this.selectedArea) {\n            this.hoverOn(area, index, event);\n        }\n    }\n\n    protected onImgLoaded(target: HTMLImageElement, preview: boolean, componentId: any) {\n        if (this.canvas && this.container) {\n            this.initCanvas(this.canvas, this.container);\n        }\n        this.loadEvents.onLoad(target, preview, componentId);\n    }\n\n    renderAreas() {\n        return this.getScaledMap(this.props.map, this.props.width, this.props.height)\n            .areas\n            .map((area: ImageMapperArea, index) => {\n                const teaName = area.group && this.props.t && this.props.t(`teas.${area.group}.name`);\n                return (\n                    <area\n                        title={teaName}\n                        alt={teaName}\n                        key={area._id || index}\n                        shape={area.shape}\n                        coords={area.coords.join(\",\")}\n                        onMouseEnter={this.hoverOn.bind(this, area, index)}\n                        onMouseLeave={this.hoverOff.bind(this, area, index)}\n                        onMouseMove={this.mouseMove.bind(this, area, index)}\n                        onClick={this.click.bind(this, area, index)}\n                        href={area.href}\n                    />\n                );\n            });\n    }\n\n    render() {\n        this.loadEvents = new SmoothImageLoadEventsWrapper(this.props.loadEvents);\n        return (\n            <div style={{\n                    ...this.styles.container,\n                    width: this.props.width,\n                    height: this.props.height\n                }}\n                 ref={node => (this.container = node)}\n                 className={this.props.containerClassName}\n            >\n                <SmoothImage\n                    src={this.props.src}\n                    previewSrc={this.props.previewSrc}\n                    imgRef={node => (this.img = node)}\n                    loadEvents={{\n                        ...this.loadEvents,\n                        onLoad: this.onImgLoaded.bind(this)\n                    }}\n                    imgProps={{\n                        style: this.styles.img,\n                        useMap: `#${this.props.map.name}`,\n                        onClick: this.imageClick.bind(this)\n                    }}\n                />\n                <canvas ref={node => (this.canvas = node)} style={this.styles.canvas} />\n                <map name={this.props.map.name} style={this.styles.map}>\n                    {this.renderAreas()}\n                </map>\n            </div>\n        );\n    }\n}\n\n\n","import {useEffect, useRef} from \"react\";\n\nexport function useIsMounted(): boolean {\n    const componentIsMounted = useRef(true)\n    useEffect(() => {\n        return () => {\n            componentIsMounted.current = false\n        }\n    }, []);\n    return componentIsMounted.current;\n}","import {useElementSize} from \"./useElementSize\";\n\nexport function useFittedScale(\n    container: HTMLElement,\n    naturalWidth: number,\n    naturalHeight: number\n): number {\n    const containerSize = useElementSize(container);\n\n    const imgProportions = naturalWidth / naturalHeight;\n    const parentProportions = containerSize.width / containerSize.height;\n\n    return imgProportions < parentProportions\n        ? containerSize.height / naturalHeight\n        : containerSize.width / naturalWidth;\n}\n","import {useLayoutEffect, useState} from \"react\";\nimport {Size2d} from \"../models/point2d\";\nimport {useIsMounted} from \"./useIsMounted\";\n\nexport function useElementSize(element: HTMLElement): Size2d {\n    const [size, setSize] = useState<Size2d>({\n        width: element.clientWidth,\n        height: element.clientHeight\n    });\n    const isMounted = useIsMounted();\n    useLayoutEffect(() => {\n        if (!isMounted) {\n            return;\n        }\n        function updateSize() {\n            isMounted && setSize({\n                width: element.clientWidth,\n                height: element.clientHeight\n            });\n        }\n        window.addEventListener('resize', updateSize);\n        updateSize();\n        return () => window.removeEventListener('resize', updateSize);\n    }, [element, isMounted]);\n    return size;\n}","import '../css/spinner.css';\nimport React, {useMemo} from \"react\";\nimport {classNames} from \"../models/reactUtils\";\nimport {SmoothImage} from \"./SmoothImage\";\nimport {CollageSources} from \"../models/collageSources\";\nimport {useTranslation} from \"react-i18next\";\n\ninterface TeapotSpinnerProps {\n    active: boolean,\n    scale: number,\n    collageSources: CollageSources\n}\n\nfunction TeapotSpinner(props: TeapotSpinnerProps) {\n    const {t} = useTranslation();\n    const dimensions = useMemo(\n        () => props.collageSources.getOverlayDimensions('teapot_spinner').scale(props.scale),\n        [props.collageSources, props.scale]\n    );\n\n    return (\n        <div className={classNames(\n            'teapot-spinner',\n            props.active ? 'active' : 'disabled'\n        )}>\n            <SmoothImage\n                componentId={'teapot_spinner'}\n                src={props.collageSources.getOverlayUrl('teapot_spinner')}\n                previewSrc={props.collageSources.getOverlayUrl('teapot_qr')}\n                imgProps={{\n                    style: {\n                        left: dimensions.left,\n                        top: dimensions.top,\n                        width: dimensions.width,\n                        height: dimensions.height,\n                    },\n                    alt: t(`teas.about.name`),\n                }}\n            />\n        </div>\n    );\n}\n\nexport default TeapotSpinner;","import '../css/spinner.css';\nimport React, {MouseEvent, useRef, useState} from \"react\";\nimport OverlayLayer from \"./OverlayLayer\";\nimport ImageMapper, {\n    ImageMapperBehaviorProps, ImageMapperMap,\n    ImageMapperProps,\n    ImageMapperStyleProps\n} from \"./ImageMapper\";\nimport {useFittedScale} from \"../hooks/useFittedScale\";\nimport {classNames} from \"../models/reactUtils\";\nimport {withTranslation} from \"react-i18next\";\nimport {CollageSources} from \"../models/collageSources\";\nimport TeapotSpinner from \"./TeapotSpinner\";\n\nconst ImageMapperTranslated = withTranslation()(ImageMapper);\n\ninterface OverlayedImageMapperProps extends\n    ImageMapperStyleProps,\n    ImageMapperBehaviorProps\n{\n    showLoader: boolean,\n    collageSources: CollageSources,\n    areasMap: ImageMapperMap,\n    fitToElement: HTMLElement,\n    overlayLayerId?: string,\n    onOverlayClick?: (event: MouseEvent, layerId: string, isTransparentArea: boolean) => void,\n    children?: JSX.Element\n}\n\nconst selfPropNames = new Set([\n    'collageSources',\n    'fitToElement',\n    'imgHeight',\n    'overlayLayerId',\n    'onOverlayLeave',\n    'onOverlayClick',\n    'children',\n]);\n\nfunction getImageMapperProps(\n    props: OverlayedImageMapperProps\n): ImageMapperStyleProps & ImageMapperBehaviorProps\n{\n    return Object.fromEntries(\n        Object.keys(props)\n            .filter(key => !selfPropNames.has(key))\n            .map(key => [key, props[key]])\n    ) as ImageMapperProps;\n}\n\nfunction OverlayedImageMapper(props: OverlayedImageMapperProps)\n{\n    const scale = useFittedScale(\n        props.fitToElement,\n        props.collageSources.full.background.width,\n        props.collageSources.full.background.height\n        );\n\n    const prevOverlayLayer = useRef<string|undefined>(undefined);\n    const [overlayHoverOnTransparent, setOverlayHoverOnTransparent] = useState<boolean|undefined>(false);\n    if (prevOverlayLayer.current !== props.overlayLayerId) {\n        prevOverlayLayer.current = props.overlayLayerId;\n    } else if (!props.overlayLayerId && overlayHoverOnTransparent) {\n        setOverlayHoverOnTransparent(false);\n    }\n\n    function onOverlayClick(event: MouseEvent, isTransparentArea: boolean) {\n        if (props.overlayLayerId && props.onOverlayClick) {\n            props.onOverlayClick(event, props.overlayLayerId, isTransparentArea);\n        }\n    }\n\n    function onOverlayMouseHover(event, isTransparentArea: boolean) {\n        if (overlayHoverOnTransparent !== isTransparentArea) {\n            setOverlayHoverOnTransparent(isTransparentArea);\n        }\n    }\n\n    function onOverlayMouseLeave() {\n        setOverlayHoverOnTransparent(undefined);\n    }\n\n    const overlay = props.overlayLayerId !== undefined && (\n        <OverlayLayer\n            layerId={props.overlayLayerId}\n            containerClass='collage-overlay-container'\n            src={props.collageSources.getOverlayUrl(props.overlayLayerId)}\n            previewSrc={props.collageSources.getOverlayUrl(props.overlayLayerId, true)}\n            dimensions={props.collageSources.getOverlayDimensions(props.overlayLayerId).scale(scale)}\n            onClick={onOverlayClick}\n            onMouseHover={onOverlayMouseHover}\n            onMouseLeave={onOverlayMouseLeave}\n            loadEvents={props.loadEvents}\n        />\n    );\n\n    const imgMapperProps = {\n        ...getImageMapperProps(props),\n        width: Math.round(props.collageSources.full.background.width * scale),\n        height: Math.round(props.collageSources.full.background.height * scale),\n        containerClassName: 'collage-bg',\n        src: props.collageSources.getBackgroundUrl(false),\n        previewSrc: props.collageSources.getBackgroundUrl(true),\n        imgWidth: props.collageSources.full.background.width,\n        map: props.areasMap\n    };\n\n    return (\n        <div style={{position: 'relative'}}\n             className={classNames(\n                 props.overlayLayerId ? 'overlay-shown' : undefined,\n                 props.overlayLayerId && overlayHoverOnTransparent === true && 'overlay-hover-on-transparent',\n                 props.overlayLayerId && overlayHoverOnTransparent === false && 'overlay-hover-on-filled',\n                 props.overlayLayerId && overlayHoverOnTransparent === undefined && 'overlay-no-hover',\n             )}\n        >\n            <ImageMapperTranslated {...imgMapperProps} />\n            {overlay}\n            <TeapotSpinner active={props.showLoader} scale={scale} collageSources={props.collageSources}/>\n            {props.children}\n        </div>\n    );\n}\n\nexport default OverlayedImageMapper;","const extractedDir = process.env.PUBLIC_URL + '/extracted';\n\n/**\n * @property left\n * @property top\n * @property width\n * @property height\n */\nexport class OverlayDimensions {\n    public constructor(\n        readonly left: number,\n        readonly top: number,\n        readonly width: number,\n        readonly height: number\n    ) {\n    }\n\n    public scale(scale: number): OverlayDimensions {\n        return new OverlayDimensions(\n            this.left * scale,\n            this.top * scale,\n            this.width * scale,\n            this.height * scale\n        )\n    }\n}\n\nexport class CollageSources {\n    public constructor(\n        public readonly fullName: string,\n        public readonly full: generatedJson.CollageFullInfo,\n        public readonly previewName: string,\n        public readonly preview: generatedJson.CollagePreviewInfo\n    ) {\n    }\n\n    public getBackgroundUrl(preview: boolean = false): string {\n        const info = this._getInfo(preview);\n        return `${extractedDir}/${info.dir}/${info.collage.background.fileName}`;\n    }\n\n    public getOverlayUrl(id: string, preview: boolean = false): string {\n        const info = this._getInfo(preview);\n        const overlayItem = info.collage.overlayItems[id];\n        return overlayItem && `${extractedDir}/${info.dir}/${overlayItem.fileName}`;\n    }\n\n    public getOverlayDimensions(id: string, preview: boolean = false): OverlayDimensions {\n        const collageItem = this.getCollageInfo(preview).overlayItems[id];\n        return collageItem && new OverlayDimensions(\n            collageItem.left,\n            collageItem.top,\n            collageItem.width,\n            collageItem.height\n        );\n    }\n\n    public getCollageInfo(preview: boolean): generatedJson.CollageFullInfo | generatedJson.CollagePreviewInfo {\n        return preview ? this.preview : this.full;\n    }\n\n    /**\n     * @param preview\n     * @return {{collage: (CollageInfo), dir: (string)}}\n     * @private\n     */\n    _getInfo(preview: boolean) {\n        return {\n            dir: preview ? this.previewName : this.fullName,\n            collage: this.getCollageInfo(preview)\n        }\n    }\n}","import {ImageMapperMap} from \"../components/ImageMapper\";\nimport {CollageSources} from \"./collageSources\";\n\nconst collageSizes: generatedJson.CollageSizeDef[] = require('../collage-info/sizes.json');\nconst areasMap: generatedJson.Area[] = require('../collage-info/areas-map.json');\n\nclass CollageSourcesSet {\n    public readonly sizesMap: Map<string, generatedJson.CollageSizeDef>;\n    public readonly previewSize: generatedJson.CollageSizeDef;\n\n    public constructor() {\n        collageSizes.sort((a, b) => a.width - b.width);\n        this.sizesMap = new Map<string, generatedJson.CollageSizeDef>(\n            collageSizes\n                .filter(size => !size.preview)\n                .map(size => [\n                    size.name,\n                    size\n                ])\n        );\n        this.previewSize =\n            collageSizes.find(size => size.preview) ||\n            collageSizes[0];\n    }\n\n    public readonly collageAspectRatio = collageSizes[0].width / collageSizes[0].height;\n\n    // noinspection JSUnusedGlobalSymbols\n    public getSizes(): generatedJson.CollageSizeDef[] {\n        return Array.from(this.sizesMap.values());\n    }\n\n    public getSources(setName: string): CollageSources {\n        if (this.sizesMap.has(setName)) {\n            return new CollageSources(\n                setName,\n                require(`../collage-info/${setName}.json`),\n                this.previewSize.name,\n                require(`../collage-info/${this.previewSize.name}.json`),\n            )\n        }\n        throw new Error('invalid setName = ' + setName);\n    }\n\n    public getAreasMap(mapName: string = 'collage'): ImageMapperMap {\n        return {\n            name: mapName,\n            areas: areasMap\n        };\n    }\n}\n\nexport default new CollageSourcesSet();","import {useState} from \"react\";\n\nexport interface ImgProEventHandlers {\n    onLoad: (target, preview, component) => void;\n    onLoading: (target, preview, component) => void;\n    onError: (target, preview, component) => void;\n    onHidden: (component) => void;\n}\n\nexport interface ImgProLoadingEvents {\n    eventHandlers: ImgProEventHandlers;\n    isLoading: boolean;\n    isPreview: boolean;\n}\n\nexport default function useImgLoadingEvents(): ImgProLoadingEvents {\n    const [loadingFull, setLoadingFull] = useState(new Set());\n    const [loadingPreview, setLoadingPreview] = useState(new Set());\n\n    const getLoading = preview => preview ? loadingPreview : loadingFull;\n    const setLoading = (preview, img) => preview ? setLoadingPreview(img) : setLoadingFull(img);\n\n    const addLoading = (component, preview) => {\n        const loading = getLoading(preview);\n        if (!loading.has(component)) {\n            loading.add(component);\n            setLoading(preview, new Set(loading));\n        }\n    }\n\n    const deleteLoading = (component, preview) => {\n        const loading = getLoading(preview);\n        if (loading.has(component)) {\n            loading.delete(component);\n            setLoading(preview, new Set(loading));\n        }\n    }\n\n    return {\n        eventHandlers: {\n            onLoad: (target, preview, component) => {\n                deleteLoading(component, preview);\n                if (!preview) {\n                    deleteLoading(component, true)\n                }\n            },\n            onLoading: (target, preview, component) => addLoading(component, preview),\n            onError: (target, preview, component) => {\n                deleteLoading(component, preview);\n            },\n            onHidden: component => {\n                deleteLoading(component, false);\n                deleteLoading(component, true);\n            }\n            },\n        isLoading: loadingFull.size > 0 || loadingPreview.size > 0,\n        isPreview: loadingPreview.size > 0\n    }\n}","import {useRef} from \"react\";\nimport {CollageSources} from \"../models/collageSources\";\n\n/**\n * true: all\n * false: none\n * string or string[]: listed items only\n */\ntype ItemIds = boolean|string|string[];\n\nfunction collectUrls(\n    sources: CollageSources, preview: boolean, items: ItemIds\n): { url: string, itemId: string }[] {\n    if (items === false) {\n        return [];\n    }\n    if (typeof items === 'string') {\n        items = [items];\n    }\n    return Object\n        .keys(sources.getCollageInfo(preview).overlayItems)\n        .filter(itemId => (items === true || (items as string[]).indexOf(itemId) >= 0))\n        .map(itemId => ({\n            url: sources.getOverlayUrl(itemId, preview),\n            itemId: itemId\n        }))\n}\n\nexport function useOverlayImagesPreloader (\n    sources: CollageSources,\n    loadPreview: ItemIds,\n    loadFull: ItemIds,\n    onLoad?: (target: HTMLImageElement, id: string, preview: boolean) => void\n) {\n    const images = useRef(new Map<string, HTMLImageElement>());\n\n    const requiredItems = ([] as [string, { preview: boolean, itemId: string }][]).concat(\n        collectUrls(sources, true, loadPreview).map(entry => [\n            entry.url,\n            { preview: true, itemId: entry.itemId }\n        ]),\n        collectUrls(sources, false, loadFull).map(entry => [\n            entry.url,\n            { preview: false, itemId: entry.itemId }\n        ]),\n    );\n    const requiredUrlsMap = new Map(requiredItems);\n    for (const existingUrl of images.current.keys()) {\n        if (requiredUrlsMap.has(existingUrl)) {\n            requiredUrlsMap.delete(existingUrl);\n        } else {\n            const existingImg = images.current.get(existingUrl);\n            existingImg && (existingImg.src = '');\n            images.current.delete(existingUrl);\n        }\n    }\n    for (const requiredUrl of requiredUrlsMap.keys()) {\n        const image = new Image();\n        image.src = requiredUrl;\n        if (onLoad) {\n            const itemInfo = requiredUrlsMap.get(requiredUrl);\n            itemInfo && (image.onload = () => onLoad(image, itemInfo.itemId, itemInfo.preview))\n        }\n        images.current.set(requiredUrl, image);\n    }\n}","type TimerHandler = (...args: any[]) => void;\n\nexport class DisposableTimers {\n    private _timeoutTimers = new Set<number>();\n    private _intervalTimers = new Set<number>();\n\n    // noinspection JSUnusedGlobalSymbols\n    public setTimeout(handler: TimerHandler, timeout?: number, ...args: any[]): number {\n        const handleId = window.setTimeout((...handlerArgs) => {\n            handler(...handlerArgs);\n            this._timeoutTimers.delete(handleId);\n        }, timeout, ...args);\n        this._timeoutTimers.add(handleId);\n        return handleId;\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    public setInterval(handler: TimerHandler, timeout?: number, ...args: any[]): number {\n        const handleId = window.setInterval((...handlerArgs) => {\n            handler(...handlerArgs);\n            this._intervalTimers.delete(handleId);\n        }, timeout, ...args);\n        this._intervalTimers.add(handleId);\n        return handleId;\n    }\n\n    public clearTimeoutTimers(): void {\n        for (const handleId of this._timeoutTimers.values()) {\n            window.clearTimeout(handleId);\n        }\n        this._timeoutTimers.clear();\n    }\n\n    public clearIntervalTimers(): void {\n        for (const handleId of this._intervalTimers.values()) {\n            window.clearInterval(handleId);\n        }\n        this._timeoutTimers.clear();\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    public clear(): void {\n        this.clearTimeoutTimers();\n        this.clearIntervalTimers();\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    get timeoutTimers(): Set<number> {\n        return this._timeoutTimers;\n    }\n\n    // noinspection JSUnusedGlobalSymbols\n    get intervalTimers(): Set<number> {\n        return this._intervalTimers;\n    }\n}","import {useRef, useState} from \"react\";\nimport {ImageMapperArea} from \"../components/ImageMapper\";\nimport {useDisposableTimers} from \"./useDisposableTimers\";\n\nexport interface MouseHoverArea {\n    hoverAreaGroup: string|undefined,\n    preloadGroup: string|undefined,\n    onMouseEnterArea: (area: ImageMapperArea) => void;\n    onMouseLeaveArea: (area: ImageMapperArea) => void;\n}\n\nexport function useMouseHoverArea(startPreloadAfterMs: number, stopPreloadAfterMs?: number): MouseHoverArea {\n    const hoverAreaGroup = useRef<string>();\n    const [preloadGroup, setPreloadGroup] = useState<string|undefined>();\n    const disposableTimers = useDisposableTimers();\n\n    function onMouseEnterArea(area: ImageMapperArea) {\n        hoverAreaGroup.current = area.group;\n        if (startPreloadAfterMs !== undefined) {\n            disposableTimers.setTimeout(() => {\n                if (hoverAreaGroup.current === area.group) {\n                    setPreloadGroup(area.group);\n                }\n            }, startPreloadAfterMs);\n        }\n    }\n    function onMouseLeaveArea(area: ImageMapperArea) {\n        if (hoverAreaGroup.current === area.group) {\n            hoverAreaGroup.current = undefined;\n        }\n        if (stopPreloadAfterMs !== undefined) {\n            disposableTimers.setTimeout(() => {\n                if (hoverAreaGroup.current !== area.group) {\n                    setPreloadGroup(undefined);\n                }\n            }, 1000);\n        }\n    }\n\n    return {\n        hoverAreaGroup: hoverAreaGroup.current,\n        preloadGroup,\n        onMouseEnterArea,\n        onMouseLeaveArea\n    };\n}","import {useEffect, useRef} from \"react\";\nimport {DisposableTimers} from \"../models/disposableTimers\";\n\nexport function useDisposableTimers(): DisposableTimers {\n    const disposableTimers = useRef<DisposableTimers>();\n    if (!disposableTimers.current) {\n        disposableTimers.current = new DisposableTimers();\n    }\n    useEffect(() => {\n        return () => {\n            // eslint-disable-next-line react-hooks/exhaustive-deps\n            disposableTimers.current && disposableTimers.current.clear();\n        }\n    }, []);\n    return disposableTimers.current;\n}","import {Dispatch, SetStateAction, useState} from \"react\";\nimport {useIsMounted} from \"./useIsMounted\";\n\nexport function useStateSafe<S>(initialState: S | (() => S)): [S, Dispatch<SetStateAction<S>>] {\n    const isMounted = useIsMounted();\n    const [state, setState] = useState(initialState);\n\n    return [\n        state,\n        value => { if (isMounted) {\n            setState(value);\n        }}\n        ];\n}","import {useEffect} from \"react\";\n\nexport function useDocumentKeyDown(listener: (event: KeyboardEvent) => any) {\n    useEffect(() => {\n        document.addEventListener(\"keydown\", listener, false);\n\n        return () => {\n            document.removeEventListener(\"keydown\", listener, false);\n        };\n    }, [listener]);\n}","import {useEffect, useRef} from \"react\";\n\nexport function useDocumentTitle(title) {\n    const oldTitle = useRef<string|undefined>();\n\n    useEffect(() => {\n        oldTitle.current = document.title;\n        document.title = title;\n        return () => {\n            document.title = oldTitle.current || '';\n        }\n    }, [title]);\n}","import {useTranslation} from \"react-i18next\";\nimport React from \"react\";\n\nfunction getImgUrl(trackedUrl: string|undefined): string {\n    if (!trackedUrl || !process.env.NODE_ENV || process.env.NODE_ENV === 'development') {\n        return process.env.PUBLIC_URL + '/hits_badge_fake.svg';\n    }\n    return 'https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=' +\n        encodeURIComponent(trackedUrl) +\n        '&count_bg=%2374655B&title_bg=%23000000&icon=&icon_color=%23E7E7E7&title=visitors&edge_flat=false';\n}\n\nfunction getGraphUrl(trackedUrl: string|undefined): string {\n    if (!trackedUrl) {\n        return '#tracked_url_not_set';\n    }\n    return 'https://hits.seeyoufarm.com/api/count/graph/dailyhits.svg?url=' +\n        encodeURIComponent(trackedUrl);\n}\n\nexport interface HitsCounterProps {\n    visible: boolean\n}\n\nexport function HitsCounter(props: HitsCounterProps) {\n    const {t} = useTranslation();\n    const trackedUrl = process.env.REACT_APP_HITS_COUNTER_TRACKED_URL;\n\n    return (\n        <a href={getGraphUrl(trackedUrl)}\n           className='hits-counter'\n           style={{display: props.visible ? 'block' : 'none'}}\n        >\n            <img\n                src={getImgUrl(trackedUrl)}\n                alt={t('actions.visitors_stats')}\n                title={t('actions.visitors_stats')}\n            />\n        </a>\n    );\n}","import '../css/collage.css';\nimport React, {MouseEvent, useState} from \"react\";\nimport OverlayedImageMapper from \"./OverlayedImageMapper\";\nimport collageSourcesSet from \"../models/collageSourcesSet\";\nimport imgLoadingEvents from \"../hooks/useImgLoadingEvents\";\nimport {ImageMapperArea} from \"./ImageMapper\";\nimport {useOverlayImagesPreloader} from \"../hooks/useOverlayImagesPreloader\";\nimport {useMouseHoverArea} from \"../hooks/useMouseHoverArea\";\nimport { useHistory } from \"react-router-dom\";\nimport {useStateSafe} from \"../hooks/useStateSafe\";\nimport {CollageSources} from \"../models/collageSources\";\nimport {useDocumentKeyDown} from \"../hooks/useDocumentKeyDown\";\nimport {useTranslation} from \"react-i18next\";\nimport {useDocumentTitle} from \"../hooks/useDocumentTitle\";\nimport {HitsCounter} from \"./HitsCounter\";\n\nexport interface CollageProps {\n    collageSources: CollageSources\n    active: boolean\n}\n\nfunction Collage(props: CollageProps) {\n    const {t} = useTranslation();\n    useDocumentTitle(t('document_title.collage'));\n    const imagesLoadingHandler = imgLoadingEvents();\n    const [containerRef, setContainerRef] = useStateSafe<HTMLDivElement|null>(null);\n    const [layerId, setLayerId] = useState<string|undefined>();\n\n    const history = useHistory();\n    const mouseHoverArea = useMouseHoverArea(1000, 1500);\n    useOverlayImagesPreloader(\n        props.collageSources,\n        props.active,\n        mouseHoverArea.preloadGroup || false\n    );\n\n    useDocumentKeyDown(event => {\n        if (event.code === 'Escape') {\n            closeOverlay();\n        }\n    });\n\n    function closeOverlay() {\n        if (layerId) {\n            setLayerId(undefined);\n            imagesLoadingHandler.eventHandlers.onHidden(layerId);\n        }\n    }\n\n    function onContainerClick(event: MouseEvent) {\n        if (event.target === event.currentTarget) {\n            closeOverlay();\n        }\n    }\n\n    function onAreaClick(area: ImageMapperArea) {\n        if (area.group) {\n            setLayerId(area.group);\n        }\n    }\n\n    function onOverlayClick(event: MouseEvent, layerId: string, isTransparentArea: boolean) {\n        if (isTransparentArea) {\n            closeOverlay();\n        } else {\n            history.push(`/description/${layerId}`)\n        }\n    }\n\n    const imageMapper = containerRef &&\n        <OverlayedImageMapper\n            collageSources={props.collageSources}\n            areasMap={collageSourcesSet.getAreasMap()}\n            overlayLayerId={layerId}\n            fitToElement={containerRef}\n            lineWidth={3}\n            onClick={onAreaClick}\n            onOverlayClick={onOverlayClick}\n            onMouseEnter={mouseHoverArea.onMouseEnterArea}\n            onMouseLeave={mouseHoverArea.onMouseLeaveArea}\n            loadEvents={imagesLoadingHandler.eventHandlers}\n            showLoader={imagesLoadingHandler.isLoading}\n        />\n\n    return (\n        <div className=\"collage-container\"\n             ref={setContainerRef}\n             onClick={onContainerClick}\n             style={props.active ? {} : {display: 'none'}}\n        >\n            {imageMapper}\n            <HitsCounter visible={layerId === 'about'}/>\n        </div>\n    );\n}\n\nexport default Collage;","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"polygon\", {\n  fill: \"#AAAAAB\",\n  points: \"96,14 82,0 48,34 14,0 0,14 34,48 0,82 14,96 48,62 82,96 96,82 62,48 \"\n});\n\nfunction SvgCloseIcon(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    x: \"0px\",\n    y: \"0px\",\n    viewBox: \"0 0 96 96\",\n    enableBackground: \"new 0 0 96 96\",\n    xmlSpace: \"preserve\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgCloseIcon);\nexport default __webpack_public_path__ + \"static/media/close_icon.283a412d.svg\";\nexport { ForwardRef as ReactComponent };","import '../css/infoWindow.css';\nimport {ReactComponent as CloseIcon} from \"../images/close_icon.svg\";\nimport {SmoothImage} from \"./SmoothImage\";\nimport React, {useState} from \"react\";\nimport {useTranslation} from \"react-i18next\";\nimport {useHistory} from \"react-router-dom\";\nimport {classNames} from \"../models/reactUtils\";\nimport {useDocumentKeyDown} from \"../hooks/useDocumentKeyDown\";\nimport {useDocumentTitle} from \"../hooks/useDocumentTitle\";\n\nexport interface TranslatedData {\n    name: string,\n    description: string[];\n}\n\nexport interface InfoWindowProps {\n    translatedData: TranslatedData,\n    imgSrc?: string,\n    previewSrc?: string\n}\n\nexport function InfoWindow(props: InfoWindowProps) {\n    const {t} = useTranslation();\n    const history = useHistory();\n\n    useDocumentTitle(t('document_title.item_description', {item: props.translatedData.name}));\n\n    function goToCollage() {\n        history.push('/collage/');\n    }\n\n    useDocumentKeyDown(event => {\n        if (event.code === 'Escape') {\n            goToCollage();\n        }\n    });\n\n    const [isImgZoomed, setImgZoomed] = useState(false);\n\n    const paragraphs = props.translatedData.description.map(\n        (paragraph, index) => <p key={index}>{paragraph}</p>\n    );\n\n    function onCloseClick() {\n        goToCollage();\n    }\n\n    function onImageClick() {\n        setImgZoomed(!isImgZoomed);\n    }\n\n    return (\n        <div className='info-window'>\n            <CloseIcon className='info-close' onClick={onCloseClick} title={t('actions.close')}/>\n            <div className='info-container'>\n                <div className='title-text'>{props.translatedData.name}</div>\n                {\n                    props.imgSrc &&\n                    <SmoothImage\n                        src={props.imgSrc}\n                        previewSrc={props.previewSrc}\n                        containerProps={{\n                            className: classNames(\n                                'smooth-image',\n                                isImgZoomed && 'zoomed'\n                            )\n                        }}\n                        imgProps={{onClick: onImageClick}}\n                    />\n                }\n                {paragraphs}\n            </div>\n        </div>\n    );\n}","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M424.5,216.5h-15.2c-12.4,0-22.8-10.7-22.8-23.4c0-6.4,2.7-12.2,7.5-16.5l9.8-9.6c9.7-9.6,9.7-25.3,0-34.9l-22.3-22.1  c-4.4-4.4-10.9-7-17.5-7c-6.6,0-13,2.6-17.5,7l-9.4,9.4c-4.5,5-10.5,7.7-17,7.7c-12.8,0-23.5-10.4-23.5-22.7V89.1  c0-13.5-10.9-25.1-24.5-25.1h-30.4c-13.6,0-24.4,11.5-24.4,25.1v15.2c0,12.3-10.7,22.7-23.5,22.7c-6.4,0-12.3-2.7-16.6-7.4l-9.7-9.6  c-4.4-4.5-10.9-7-17.5-7s-13,2.6-17.5,7L110,132c-9.6,9.6-9.6,25.3,0,34.8l9.4,9.4c5,4.5,7.8,10.5,7.8,16.9  c0,12.8-10.4,23.4-22.8,23.4H89.2c-13.7,0-25.2,10.7-25.2,24.3V256v15.2c0,13.5,11.5,24.3,25.2,24.3h15.2  c12.4,0,22.8,10.7,22.8,23.4c0,6.4-2.8,12.4-7.8,16.9l-9.4,9.3c-9.6,9.6-9.6,25.3,0,34.8l22.3,22.2c4.4,4.5,10.9,7,17.5,7  c6.6,0,13-2.6,17.5-7l9.7-9.6c4.2-4.7,10.2-7.4,16.6-7.4c12.8,0,23.5,10.4,23.5,22.7v15.2c0,13.5,10.8,25.1,24.5,25.1h30.4  c13.6,0,24.4-11.5,24.4-25.1v-15.2c0-12.3,10.7-22.7,23.5-22.7c6.4,0,12.4,2.8,17,7.7l9.4,9.4c4.5,4.4,10.9,7,17.5,7  c6.6,0,13-2.6,17.5-7l22.3-22.2c9.6-9.6,9.6-25.3,0-34.9l-9.8-9.6c-4.8-4.3-7.5-10.2-7.5-16.5c0-12.8,10.4-23.4,22.8-23.4h15.2  c13.6,0,23.3-10.7,23.3-24.3V256v-15.2C447.8,227.2,438.1,216.5,424.5,216.5z M336.8,256L336.8,256c0,44.1-35.7,80-80,80  c-44.3,0-80-35.9-80-80l0,0l0,0c0-44.1,35.7-80,80-80C301.1,176,336.8,211.9,336.8,256L336.8,256z\"\n});\n\nfunction SvgQualityGear(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    height: \"512px\",\n    id: \"Layer_1\",\n    style: {\n      enableBackground: \"new 0 0 512 512\"\n    },\n    viewBox: \"0 0 512 512\",\n    width: \"512px\",\n    xmlSpace: \"preserve\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgQualityGear);\nexport default __webpack_public_path__ + \"static/media/quality_gear.bdc11cc2.svg\";\nexport { ForwardRef as ReactComponent };","import React from \"react\";\nimport { Button, Wrapper, Menu, MenuItem } from 'react-aria-menubutton';\nimport {classNames} from \"../models/reactUtils\";\nimport {ReactComponent as GearIcon} from \"../images/quality_gear.svg\";\nimport '../css/qualitySelector.css';\nimport {useTranslation} from \"react-i18next\";\n\nexport interface QualitySelectorProps {\n    sizes: generatedJson.CollageSizeDef[],\n    currentSize: string,\n    onChange?: (sizeName: string) => void\n}\n\nexport function QualitySelector(props: QualitySelectorProps) {\n    const {t} = useTranslation();\n    const sizeShortName = t('sizes.' + props.currentSize)[0];\n\n    const menuItems = props.sizes.map((sizeDef, index) => {\n        return (\n            <MenuItem\n                className={classNames([\n                    'quality-selector-option',\n                    props.currentSize === sizeDef.name ? 'current-option' : undefined\n                ])}\n                value={sizeDef.name}\n                key={index}\n            >\n                <span className=\"option-mark\">{props.currentSize === sizeDef.name ? '✓' : ''}</span>\n                <span className=\"quality-name\">\n                    {t('sizes.' + sizeDef.name)}\n                </span>\n                <span className=\"quality-resolution\">\n                    {`${sizeDef.width} × ${sizeDef.height}`}\n                </span>\n            </MenuItem>\n        );\n    });\n\n    function onSelection(val: string) {\n        props.onChange && props.onChange(val);\n    }\n\n    return (\n        <Wrapper\n            className='quality-selector'\n            onSelection={onSelection}\n        >\n            <Button className='quality-selector-button' tag={'div'} title={t('actions.select_picture_quality')}>\n                <GearIcon className=\"quality-gear-icon\"/>\n                <div className='quality-letter'>{sizeShortName}</div>\n            </Button>\n            <Menu className='quality-selector-menu'>\n                <div>\n                    {menuItems}\n                </div>\n            </Menu>\n        </Wrapper>\n    );\n}","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  fillRule: \"evenodd\",\n  d: \"M1 1v6h2V3h4V1H1zm2 12H1v6h6v-2H3v-4zm14 4h-4v2h6v-6h-2v4zm0-16h-4v2h4v4h2V1h-2z\"\n});\n\nfunction SvgFullScreen(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgFullScreen);\nexport default __webpack_public_path__ + \"static/media/full_screen.bc228e95.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M0,280.5h76.5V357h51V229.5H0V280.5z M76.5,76.5H0v51h127.5V0h-51V76.5z M229.5,357h51v-76.5H357v-51H229.5V357z  M280.5,76.5V0h-51v127.5H357v-51H280.5z\"\n});\n\nfunction SvgFullScreenExit(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    x: \"0px\",\n    y: \"0px\",\n    width: \"357px\",\n    height: \"357px\",\n    viewBox: \"0 0 357 357\",\n    style: {\n      enableBackground: \"new 0 0 357 357\"\n    },\n    xmlSpace: \"preserve\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgFullScreenExit);\nexport default __webpack_public_path__ + \"static/media/full_screen_exit.b88f3e96.svg\";\nexport { ForwardRef as ReactComponent };","import {ReactComponent as EnterIcon} from \"../images/full_screen.svg\";\nimport {ReactComponent as ExitIcon} from \"../images/full_screen_exit.svg\";\nimport '../css/fullScreenSwitch.css';\nimport React from \"react\";\nimport screenFull from \"screenfull\";\nimport {useStateSafe} from \"../hooks/useStateSafe\";\nimport {useTranslation} from \"react-i18next\";\n\nexport function isFullScreenEnabled(): boolean {\n    return screenFull.isEnabled;\n}\n\nexport function FullScreenSwitch() {\n    const {t} = useTranslation();\n    const [isFullscreen, setIsFullscreen] = useStateSafe(screenFull.isEnabled && screenFull.isFullscreen);\n\n    function onClick() {\n        if (screenFull.isEnabled) {\n            if (screenFull.isFullscreen) {\n                screenFull.exit().then(() => setIsFullscreen(false));\n            } else {\n                screenFull.request().then(() => setIsFullscreen(true));\n            }\n        }\n    }\n\n    const title = isFullscreen ? t('actions.exit_fullscreen') : t('actions.enter_fullscreen');\n\n    return (\n        <div className='full-screen-switch' onClick={onClick} title={title}>\n            {isFullscreen ? <ExitIcon/> : <EnterIcon/>}\n        </div>\n    );\n}","import {useStateSafe} from \"./useStateSafe\";\nimport {i18n} from \"i18next\";\n\nfunction clearBackendCacheIfFailed(i18n: i18n, lang: string) {\n    const backendState = i18n.services?.backendConnector?.state;\n    if (backendState && backendState[`${lang}|translation`] === -1) {\n        delete backendState[`${lang}|translation`];\n    }\n}\n\nexport function getSupportedLanguages(i18n: i18n): string[] {\n    return i18n.services.languageUtils.supportedLngs\n        ? i18n.services.languageUtils.supportedLngs.filter(lang => lang !== 'cimode')\n        : [];\n}\n\nfunction getInitLanguage(i18n: i18n): string {\n    if (i18n.services.resourceStore.data[i18n.language] !== undefined) {\n        return i18n.language;\n    }\n    const fallbackLanguages = i18n.services.languageUtils.getFallbackCodes(\n        // using fallbackLng in options forces fetching all items\n        getSupportedLanguages(i18n),\n        i18n.language\n    );\n    if (fallbackLanguages) {\n        const foundFallback = fallbackLanguages.find(lang => lang !== i18n.language);\n        if (foundFallback) {\n            return foundFallback\n        }\n    }\n    return i18n.language;\n}\n\nexport interface LanguageState {\n    currentLang: string,\n    changeLanguage: (lang: string) => Promise<string>\n}\n\nexport function useLanguage(i18n: i18n): LanguageState {\n    const [currentLang, setCurrentLang] = useStateSafe(() => {\n        const initLang = getInitLanguage(i18n);\n        if (initLang !== i18n.language) {\n            // noinspection JSIgnoredPromiseFromCall\n            i18n.changeLanguage(initLang);\n        }\n        return initLang;\n    });\n\n    async function changeLanguage(lang: string) {\n        setCurrentLang(lang);\n        try {\n            clearBackendCacheIfFailed(i18n, lang);\n            await i18n.changeLanguage(lang);\n            if (i18n.services.resourceStore.data[lang] === undefined) {\n                setCurrentLang(currentLang);\n                await i18n.changeLanguage(currentLang);\n                return currentLang;\n            }\n            return lang;\n        } catch (e) {\n            setCurrentLang(currentLang);\n            return currentLang;\n        }\n    }\n\n    return {\n        currentLang,\n        changeLanguage\n    }\n}","import {capitalizeFirstLetter} from \"../models/strUtils\";\nimport React from \"react\";\nimport '../css/languageSelector.css';\nimport {classNames} from \"../models/reactUtils\";\nimport {useTranslation} from \"react-i18next\";\nimport {getSupportedLanguages} from \"../hooks/useLanguage\";\n\nexport interface LanguageSelectorProps {\n    language: string,\n    onChange?: (lang: string) => void\n}\n\nexport function LanguageSelector(props: LanguageSelectorProps) {\n    const {i18n} = useTranslation();\n    const langWithoutCode = props.language &&\n        i18n.services.languageUtils.getLanguagePartFromCode(props.language);\n    const supportedLngs = getSupportedLanguages(i18n);\n    const currentLangIndex = supportedLngs.indexOf(langWithoutCode);\n\n    const buttons = supportedLngs.map((lang, index) =>\n        <div\n            className={classNames(\n                'lang-selector-option',\n                index === currentLangIndex ? 'lang-current' : undefined\n             )}\n             onClick={() => props.onChange && props.onChange(lang)}\n             key={index}\n        >\n            {capitalizeFirstLetter(lang)}\n        </div>\n    );\n\n    return (\n        <div className='lang-selector'>\n            <div\n                className={classNames(\n                    'lang-selector-highlight',\n                    'highlight-index-' + currentLangIndex\n                )}\n            />\n            {buttons}\n        </div>\n    );\n}","export function capitalizeFirstLetter(string) {\n    return string.charAt(0).toUpperCase() + string.slice(1);\n}","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  fillRule: \"evenodd\",\n  clipRule: \"evenodd\",\n  fill: \"#181616\",\n  d: \"M25 10c-8.3 0-15 6.7-15 15 0 6.6 4.3 12.2 10.3 14.2.8.1 1-.3 1-.7v-2.6c-4.2.9-5.1-2-5.1-2-.7-1.7-1.7-2.2-1.7-2.2-1.4-.9.1-.9.1-.9 1.5.1 2.3 1.5 2.3 1.5 1.3 2.3 3.5 1.6 4.4 1.2.1-1 .5-1.6 1-2-3.3-.4-6.8-1.7-6.8-7.4 0-1.6.6-3 1.5-4-.2-.4-.7-1.9.1-4 0 0 1.3-.4 4.1 1.5 1.2-.3 2.5-.5 3.8-.5 1.3 0 2.6.2 3.8.5 2.9-1.9 4.1-1.5 4.1-1.5.8 2.1.3 3.6.1 4 1 1 1.5 2.4 1.5 4 0 5.8-3.5 7-6.8 7.4.5.5 1 1.4 1 2.8v4.1c0 .4.3.9 1 .7 6-2 10.2-7.6 10.2-14.2C40 16.7 33.3 10 25 10z\"\n});\n\nfunction SvgGithubLogo(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 50 50\",\n    enableBackground: \"new 0 0 50 50\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgGithubLogo);\nexport default __webpack_public_path__ + \"static/media/github_logo.b0156332.svg\";\nexport { ForwardRef as ReactComponent };","import '../css/githubLink.css';\nimport {ReactComponent as Icon} from \"../images/github_logo.svg\";\nimport React from \"react\";\nimport {useTranslation} from \"react-i18next\";\n\nexport interface GithubLinkProps {\n    url: string\n}\n\nexport function GithubLink(props: GithubLinkProps) {\n    const {t} = useTranslation();\n\n    return (\n        <div className='github-link' title={t('actions.view_on_github')}>\n            <a href={props.url}>\n                <Icon/>\n            </a>\n        </div>\n    );\n}","import '../css/aboutLink.css';\nimport React from \"react\";\nimport {useTranslation} from \"react-i18next\";\nimport {useHistory} from \"react-router-dom\";\n\nexport function AboutLink() {\n    const {t} = useTranslation();\n    const history = useHistory();\n\n    return (\n        <div\n            className='about-link'\n            title={t('teas.about.name')}\n            onClick={() => history.push('/description/about')}\n        >\n            ?\n        </div>\n    );\n}","import {QualitySelector} from \"./QualitySelector\";\nimport collageSourcesSet from \"../models/collageSourcesSet\";\nimport {FullScreenSwitch, isFullScreenEnabled} from \"./FullScreenSwitch\";\nimport {LanguageSelector} from \"./LanguageSelector\";\nimport React from \"react\";\nimport {useTranslation} from \"react-i18next\";\nimport {GithubLink} from \"./GithubLink\";\nimport {useLanguage} from \"../hooks/useLanguage\";\nimport {AboutLink} from \"./AboutLink\";\n\nexport interface ControlPanelProps {\n    collageSizeName: string,\n    onCollageSizeChange?: (sizeName: string) => void\n}\n\nexport function ControlPanel(props: ControlPanelProps) {\n    const {i18n} = useTranslation();\n    const {currentLang, changeLanguage} = useLanguage(i18n);\n\n    return (\n        <div className=\"control-panel\">\n            <LanguageSelector language={currentLang} onChange={changeLanguage}/>\n            <div className='control-panel-center'/>\n            <AboutLink/>\n            <GithubLink url={'https://github.com/cardinalby/tea-collage'}/>\n            <div className='control-panel-center'/>\n            <QualitySelector\n                sizes={collageSourcesSet.getSizes()}\n                currentSize={props.collageSizeName}\n                onChange={props.onCollageSizeChange}\n            />\n            {isFullScreenEnabled() && <FullScreenSwitch/>}\n        </div>\n    );\n}","const photosInfo: generatedJson.PhotosInfo = require('../collage-info/photos-info.json');\n\nconst photosDirUrl = process.env.PUBLIC_URL + '/tea_photos';\n\nfunction getDirUrl(preview: boolean): string {\n    return preview\n        ? photosDirUrl + '/' + photosInfo.previewsDirName\n        : photosDirUrl;\n}\n\nclass PhotosSources {\n    // noinspection JSUnusedGlobalSymbols\n    public getPhotoUrl(fileName: string, preview: boolean = false): string|undefined {\n        if (!photosInfo.files.find(file => file === fileName)) {\n            return undefined;\n        }\n        return getDirUrl(preview) + '/' + fileName;\n    }\n\n    public getTeaPhotoUrl(teaName: string, preview: boolean = false): string|undefined {\n        if (!photosInfo.teas.hasOwnProperty(teaName)) {\n            return undefined;\n        }\n        const fileIndex = photosInfo.teas[teaName];\n        if (fileIndex >= photosInfo.files.length) {\n            return undefined;\n        }\n        const fileName = photosInfo.files[photosInfo.teas[teaName]];\n\n        return getDirUrl(preview) + '/' + fileName;\n    }\n}\n\nexport default new PhotosSources();","function calcScore(factor, actual, worst, zero, best) {\n    const isWorseThanTarget = worst > best\n        ? actual > zero\n        : actual < zero;\n    return factor * (isWorseThanTarget\n        ? Math.max((actual - zero) / (zero - worst), -1)\n        : Math.min((actual - zero) / (best - zero), 1));\n}\n\nfunction toBytesPerSec(mBitsPerSec: number): number {\n    return mBitsPerSec * 1024 * 1024 / 8;\n}\n\nfunction isMobileDevice(): boolean {\n    return (/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i\n        .test(navigator.userAgent));\n}\n\nfunction isUserGoingToZoom(): boolean {\n    return isMobileDevice() || Math.max(window.screen.width, window.screen.height) < 700;\n}\n\nexport function getRecommendedCollageSize(sizes: generatedJson.CollageSizeDef[]): string {\n    const sizesScore = new Map<string, number>(sizes.map(size => [size.name, 0]));\n    function addScore(name: string, score: number) {\n        const currentScore = sizesScore.get(name) || 0;\n        sizesScore.set(name, currentScore + score);\n    }\n\n    const connection = navigator.connection;\n    const downlink = connection && connection.downlink && toBytesPerSec(connection.downlink);\n    if (downlink) {\n        sizes.forEach(size => {\n            const estimatedLoadTimeSec = size.avgImgSize / downlink;\n            const bestLoadTimeSec = size.avgImgSize / toBytesPerSec(10); // due to chrome fingerprinting protection\n            const speedScore = calcScore(\n                5,\n                estimatedLoadTimeSec,\n                25,\n                Math.max(1.5, bestLoadTimeSec) + 0.1,\n                bestLoadTimeSec);\n            addScore(size.name, speedScore);\n        });\n    }\n\n    if (connection && connection.saveData === true) {\n        sizes.forEach(size => {\n            const saveDataScore = calcScore(2, size.avgImgSize * 1024, 50, 30, 15);\n            addScore(size.name, saveDataScore);\n        });\n    }\n\n    const biggestScreenDimensionPx = Math.max(window.screen.width, window.screen.height) * window.devicePixelRatio;\n    const bestScreenBigDimension = isUserGoingToZoom() ? biggestScreenDimensionPx * 2 : biggestScreenDimensionPx;\n    sizes.forEach(size => {\n        const biggestImgDimensionPx = Math.max(size.width, size.height);\n        const screenSizeScore = calcScore(\n            2,\n            biggestImgDimensionPx,\n            biggestScreenDimensionPx * 0.3,\n            biggestScreenDimensionPx * 0.5,\n            bestScreenBigDimension);\n        addScore(size.name, screenSizeScore);\n    });\n\n    return sizes.reduce(function(prev, current) {\n        return ((sizesScore.get(prev.name) || 0) > (sizesScore.get(current.name) || 0)) ? prev : current\n    }).name;\n}","import {useStateSafe} from \"./useStateSafe\";\nimport collageSourcesSet from \"../models/collageSourcesSet\";\nimport {getRecommendedCollageSize} from \"../models/sizeAutoSelector\";\n\nconst STORAGE_SIZE_PREF_KEY = 'collage_size';\n\nexport function useCollageSize(): [string, (newSize: string) => void] {\n    const [size, setSize] = useStateSafe(() => {\n        const prefSize = sessionStorage.getItem(STORAGE_SIZE_PREF_KEY);\n        if (prefSize) {\n            return prefSize;\n        }\n        const recommendedSize = getRecommendedCollageSize(collageSourcesSet.getSizes());\n        sessionStorage.setItem(STORAGE_SIZE_PREF_KEY, recommendedSize);\n        return recommendedSize;\n    })\n\n    return [\n        size,\n        (size: string) => {\n            sessionStorage.setItem(STORAGE_SIZE_PREF_KEY, size);\n            setSize(size);\n        }\n    ];\n}","import {useHistory} from \"react-router-dom\";\nimport Collage from \"./Collage\";\nimport {InfoWindow, TranslatedData} from \"./InfoWindow\";\nimport {ControlPanel} from \"./ControlPanel\";\nimport React, {SyntheticEvent, useMemo} from \"react\";\nimport collageSourcesSet from \"../models/collageSourcesSet\";\nimport {useWindowAspectRatioClass} from \"../hooks/useWindowAspectRatio\";\nimport {useTranslation} from \"react-i18next\";\nimport {Redirect} from \"react-router\";\nimport photosSources from \"../models/photosSources\";\nimport {useCollageSize} from \"../hooks/useCollageSize\";\nimport {useHtmlElementLang} from \"../hooks/useHtmlElementLang\";\n\nexport interface AppContentsProps {\n    section: string,\n    itemId?: string\n}\n\nexport function AppContents(props: AppContentsProps) {\n    const history = useHistory();\n    const {t, i18n} = useTranslation();\n    useHtmlElementLang(i18n.language);\n    const [collageSizeName, setCollageSizeName] = useCollageSize();\n    const collageSources = useMemo(() =>\n            collageSourcesSet.getSources(collageSizeName),\n        [collageSizeName]\n    );\n    useWindowAspectRatioClass(document.body, {\n        'horizontal-control-panel': aspectRatio => aspectRatio < collageSourcesSet.collageAspectRatio\n    });\n\n    function onMainAreaClick(event: SyntheticEvent<HTMLDivElement, MouseEvent>) {\n        if (event.target === event.currentTarget) {\n            history.replace('/collage/');\n        }\n    }\n\n    let infoWindow: JSX.Element|undefined = undefined;\n    let redirect = true;\n\n    if (props.section === 'description' && props.itemId) {\n        const translatedData = t(\n            `teas.${props.itemId}`,\n            { returnObjects: true, defaultValue: false }\n            ) as TranslatedData;\n        if (translatedData) {\n            const [imgSrc, previewSrc] = [false, true]\n                .map(preview => photosSources.getTeaPhotoUrl(props.itemId!!, preview));\n\n            infoWindow = (<InfoWindow\n                translatedData={translatedData}\n                imgSrc={imgSrc}\n                previewSrc={previewSrc}\n                />);\n            redirect = false;\n        }\n    } else if (props.section === 'collage' && !props.itemId) {\n        redirect = false;\n    }\n\n    return (\n        <div className='app'>\n            <div className={'main-area'} onClick={onMainAreaClick}>\n                {redirect && <Redirect to='/collage/'/>}\n                <Collage\n                    active={props.section === 'collage'}\n                    collageSources={collageSources}\n                />\n                {infoWindow}\n            </div>\n            <ControlPanel collageSizeName={collageSizeName} onCollageSizeChange={setCollageSizeName}/>\n        </div>\n    );\n}","import {useEffect, useRef} from \"react\";\n\nexport function useHtmlElementLang(lang: string) {\n    const oldLang = useRef<string|undefined>();\n\n    useEffect(() => {\n        oldLang.current = document.title;\n        document.documentElement.lang = lang;\n        return () => {\n            document.documentElement.lang = oldLang.current || '';\n        }\n    }, [lang]);\n}","import {useLayoutEffect} from \"react\";\n\nexport interface AspectRatioClasses {\n    // className will be set to element if callback returns true\n    [className: string]: (aspectRatio: number) => boolean\n}\n\nexport function useWindowAspectRatioClass(element: HTMLElement, classes: AspectRatioClasses) {\n    useLayoutEffect(() => {\n        function updateAspectRatio() {\n            let aspectRatio = window.innerWidth / window.innerHeight;\n            for (const className in classes) {\n                if (classes.hasOwnProperty(className)) {\n                    element.classList.toggle(className, classes[className](aspectRatio));\n                }\n            }\n        }\n        window.addEventListener('resize', updateAspectRatio);\n        updateAspectRatio();\n        return () => window.removeEventListener('resize', updateAspectRatio);\n    }, [element, classes]);\n}","import '../css/app.css';\n\nimport '../i18n/config';\nimport React from \"react\";\nimport {HashRouter, Route} from 'react-router-dom'\nimport {RouteComponentProps, Redirect} from \"react-router\";\nimport {withTranslation} from \"react-i18next\";\nimport {AppContents} from \"./AppContents\";\n\ntype RoutesProps = [RouteComponentProps<any>];\n\nfunction getRouteParam(routeProps: RoutesProps, paramName: string): string|undefined {\n    const foundProps = routeProps\n        .map(props => props.match?.params[paramName])\n        .filter(param => param);\n    return foundProps.length ? foundProps[0] : undefined;\n}\n\nfunction App() {\n    function renderContents(routeProps: RoutesProps) {\n        const section = getRouteParam(routeProps, 'section') || 'collage';\n        const itemId = getRouteParam(routeProps, 'itemId');\n\n        const TranslatedContents = withTranslation()(AppContents);\n\n        return (\n            <React.Suspense fallback=\"loading...\">\n                <TranslatedContents section={section} itemId={itemId}/>\n            </React.Suspense>\n        );\n    }\n\n    return (\n        <HashRouter>\n            <Route path=\"/:section(collage|description)/:itemId?\"\n                   render={(...routeProps) => renderContents(routeProps)}/>\n            <Route exact path=\"/\">\n                <Redirect to=\"/collage/\" />\n            </Route>\n        </HashRouter>\n    );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}